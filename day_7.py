from termcolor import colored
import os
#os.system("color")


input = """.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
..............."""

real_input = """......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^.^.^.^...................................................................
.............................................................................................................................................
..................................................................^...^.^.^..................................................................
.............................................................................................................................................
.................................................................^...^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.^.........^................................................................
.............................................................................................................................................
...............................................................^.^.^.^.......^...............................................................
.............................................................................................................................................
..............................................................^.^...^.....^...^..............................................................
.............................................................................................................................................
.............................................................^.....^.^.^.^.^...^.............................................................
.............................................................................................................................................
............................................................^.^...^...^.^.^.^.^.^............................................................
.............................................................................................................................................
...........................................................^.^...^.^.^...^.^.^.^.^...........................................................
.............................................................................................................................................
..........................................................^.^.^.^.^.......^.^.^.^.^..........................................................
.............................................................................................................................................
.........................................................^...^.^.^...^.^.....^.....^.........................................................
.............................................................................................................................................
........................................................^.^.^.^...^.^.^...^...^.^...^........................................................
.............................................................................................................................................
.......................................................^...^.^.^.....^...^.^.^.^...^.^.......................................................
.............................................................................................................................................
......................................................^.....^.^.^.^.^...^.^...^.^.^.^.^......................................................
.............................................................................................................................................
.....................................................^.^...^.^.^.^.^...^.^.^...^...^.^.^.....................................................
.............................................................................................................................................
....................................................^.....^.^.^.^.^.^.^.^.^...^.^...^.^.^....................................................
.............................................................................................................................................
...................................................^.......^.^...^...^.^...^.^.^...^.^.^.^...................................................
.............................................................................................................................................
..................................................^.^.^.^.^.^.^...^...^.......^.....^.^.^.^..................................................
.............................................................................................................................................
.................................................^...^.^...........^.^.....^.^.^.........^.^.................................................
.............................................................................................................................................
................................................^.^.....^.^...^.^.^.......^.^.^...^.^.^.^.^.^................................................
.............................................................................................................................................
...............................................^.^.^.^.^.^.....^.^.^.......^.^...^.^.^...^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.....^...^...^.^.^.....^...........^.^.^.^.^..............................................
.............................................................................................................................................
.............................................^.^.....^.^.......^...^.^.^.^.^.^.^.....^.......^.^.............................................
.............................................................................................................................................
............................................^...^.^.^.^.^.^.^.^...^.^...^.^.......^.^.....^.^.^.^............................................
.............................................................................................................................................
...........................................^.^.^.^.^...^.^...^.^.^.^.^.^.^.^.^.....^.^.^.......^.^...........................................
.............................................................................................................................................
..........................................^.^...^.^...^.^.^...^.^...^.^.^.^.^...^.^...^.^.^.....^.^..........................................
.............................................................................................................................................
.........................................^...^...^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^...^.^...^...^.^.........................................
.............................................................................................................................................
........................................^.^.....^.^.^.^...^.^...^.^.^.^.^.^.^...^...^...^.....^.^.^.^........................................
.............................................................................................................................................
.......................................^.^...^.....^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.......................................
.............................................................................................................................................
......................................^.^...^.^.....^.^...^.^.^.^...^.^.^.^.....^.^...^.^.^...^.......^......................................
.............................................................................................................................................
.....................................^.^.^...^.^.^.......^...^.^.^.^.^...^.^.^...^.^.....^.^.........^.^.....................................
.............................................................................................................................................
....................................^...^.....^.^...^.^.......^.^.....^.....^.^...^...^.^.^...^.^.....^.^....................................
.............................................................................................................................................
...................................^.....^.^.^.^.^.^.^...^.^...^.^...^...^...^.^.^...^.^.^.^...^.^.^.^.^.^...................................
.............................................................................................................................................
..................................^.^.^...^.^...^.^.^.......^.^...^.^.^...^.^.^.^.^.....^.^.^.^...^.^.^.^.^..................................
.............................................................................................................................................
.................................^.^.^.....^.....^...^...^.^.^.^.^.^.^.^...^.^.^.^...^...^.^...^.^...^.....^.................................
.............................................................................................................................................
................................^.........^...^...^.^.^.^...^.^...^.^.......^.^.^.^.^.^.^.^.^.^.............^................................
.............................................................................................................................................
...............................^...^.^...^.^.^...^.^.^.....^...^...^...^...^.^.^.^.....^...^.^.^.^.^.^...^.^.^...............................
.............................................................................................................................................
..............................^.^.^.^.^.^.....^.^.^...^...^.^.^...........^.^...^.^.^.^.^...^.^.^.^.....^.^...^..............................
.............................................................................................................................................
.............................^...^.^.^...^.^...^...^.^.....^.^.^...^.^.^...^...^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.............................
.............................................................................................................................................
............................^...^...^...^.^.^...^...^...^.^...^.^.^.^.^.^.^.^...^.^.^.^.^...^.^...^.^.....^.^.^.^............................
.............................................................................................................................................
...........................^.^...^.^...^...^.^.^.^...^.^.^.^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.^...........................
.............................................................................................................................................
..........................^.....^.^.^...^...^.^.^...^.^.^.^.^.^.^.^.^...^.^.....^.^.......^.....^.^.^.^.^.^.^.^.^.^..........................
.............................................................................................................................................
.........................^.^.^.^.^.^.^.^...^.^.....^.^.^...^.^.^.^.....^.^.^...^.^...^.^.^.^.^...^.^...^.^.^.^...^.^.........................
.............................................................................................................................................
........................^.^.^.^.^.^.^.^.....^.^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^.^.....^.....^.^.....^...^.^.......^........................
.............................................................................................................................................
.......................^.....^.^.^.^...^.^...^.^.^.^.^.^...^.^.^.^...^...^.^.^.^...^.^.^.......^.^...^.^.^.^.^.^...^.^.......................
.............................................................................................................................................
......................^...^...^...^.^...^.^.^.....^.^.^...^.........^.^...^.^.^...^.^...........^.^.^.^.....^.^.....^.^......................
.............................................................................................................................................
.....................^...^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.....^.^...^.^.^.^.^.^.^.......^.^.^.^.^...^...^.^.....................
.............................................................................................................................................
....................^.^.....^.^.^.^.^.^.^.....^.^...^...^.^.^.^.^.^.....^...^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^.^...^.^....................
.............................................................................................................................................
...................^.^.^.^.^...^.^.^.^...^...^.^.^.....^.....^...^...^.^...^.^.^.^.^...^.....^...^.^...^.^.............^.^...................
.............................................................................................................................................
..................^.^.^.^.^.^.^.....^.^...^...^.^.......^.^.^.^.^.^...^.^.^...^.^.^.......^.^.^.^.^.^...^.^.^...^.^...^.^.^..................
.............................................................................................................................................
.................^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^...............^.^...^...^.^.^.....^.^...^.^.^.^.^...^.....^...^...^.^.^.................
.............................................................................................................................................
................^.^.^.^...^.^.....^.^.^.^.^.^...^.^.^.^...^...^.....^.^...^.^.^.^...^.^.^...^.^.^.....^.......^.^.^.....^.^.^................
.............................................................................................................................................
...............^.^.^.^.^...^.^.^...^.^...^.^.....^...^.^.^...^.....^.^.^.....^.^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.......^.^...............
.............................................................................................................................................
..............^.^.^.^...^.^.^.^.^.........^.^.......^.^.....^.......^.^.^.^.^.^...^.......^.^.^.^.......^.....^.^...^.....^.^.^..............
.............................................................................................................................................
.............^.^...^.^.......^.....^.^.^...^.......^.....^.....^...^.^.^.^.^.^.....^.^.....^.^.^.^.^.^...........^.^.^.^...^...^.............
.............................................................................................................................................
............^.^...^...^.^.^.^.^...^...^.......^.....^.^.....^.^...^...^.^.^...^.^...^.....^.....^...^.^.^.^.^.^...^...^.^...^.^.^............
.............................................................................................................................................
...........^.....^.^.^.^...^.^.^.^.....^...........^.^.^...^.^.^.^.^.^.....^.^...^.^...^...^...^...^.^.^...^.^.^.^.^.^.^...^.^...^...........
.............................................................................................................................................
..........^.^.^.^...^.^.......^.^.^.^...^.^.^.^...^.^.....^.^.^.^...^...^...^.^...^.^...^.^...^.^.^.^.......^.^.^.^.^...^...^.^.^.^..........
.............................................................................................................................................
.........^.^.^.^...^.^...^.......^.^...^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.......^...^.....^.^.^...^...^.........^...^.^...^.^.........
.............................................................................................................................................
........^.^.^...^...^...^.^.^.^.^.^.^.^.....^.^.^.......^.^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.^...^.^.^.^...^...^.^.^...........^.^.^........
.............................................................................................................................................
.......^.^.^.^.^...^.^.^.^...^.^.....^.^.^.^.....^.^.....^.^.......^.^.^.^.^.^.......^.^.......^.^.^.^.....^...........^.^.^...^.^...^.......
.............................................................................................................................................
......^.^.^.^.^.^...^.^...^.^.^.^.....^.....^.^...^...^.^.^.....^...^.^.....^.^.^.^...^.^.^.^.....^...^.^.....^...^.......^.....^.....^......
.............................................................................................................................................
.....^.^.^...^.^.^.^.^.^.^...^.^...^.^.^.^.^.^.......^.^.^...^.........^.....^...^.^.^.^.........^.^.......^.^...^...^.^.^.....^.^...^.^.....
.............................................................................................................................................
....^...^.^.^.^.^.^.^.^.^.^...^.^...^.^...^.^.^.^.^.....^.^.......^.^...^.^...^.^.^.^.....^.^.^.....^.^...^.....^.^.^.^.^.........^.....^....
.............................................................................................................................................
...^.^.^.^...^...^.........^.^.^.^.^.^.^.^.^.^...^...........^.^...^...^.......^...^.^.^.^.^...^.^.^.^.......^.^...^.^...^.^.^.....^...^.^...
.............................................................................................................................................
..^.......^.......^.^.^...^.^.^.^.^.^.......^...^.^...^.^...^.^.^...^.^.....^...^.^.^.^.^...^...^...^.^.^.^.........^.^...^.^.^.^.^.^...^.^..
.............................................................................................................................................
.^.^.^.^.^.^.^.^.........^.........^...^.^.^.^...^...^.....^.......^...^.........^.^.^.^.^.^.^.^.^.^...^.^.^.^.......^.^.^...^.^.^.^.^.^...^.
............................................................................................................................................."""

input_matrix: list = list()



for line in real_input.split():
    helper_list:list = list()
    for character in line:
        helper_list.append(character)
    input_matrix.append(helper_list.copy())


#print pretty beams
def print_manifold():
    for line in input_matrix:
        for character in line:
            if character == "|":
                print(colored(character, "red"), end="")
            elif character=="^":
                print(colored(character, "green"), end="")
            elif character == "S":
                print(colored(character, "blue"), end="")
            else:
                print(character, end="")
        print()
    print()

#--------------------------------------------------------------------------------------------------------------------------------------
#part 1
#solution = 0
# #beam downward trajectory
# for line_index, line in enumerate(input_matrix[:-1]):
#     #print_manifold()
#     for index, value in enumerate(line):
#         split = False
#         #Starting beam
#         if (value == "S"):
#             input_matrix[line_index+1][index] = "|"
        
#         #continue beam downwards, if theres nothing in the way
#         if value == "|" and input_matrix[line_index+1][index] == ".":
#             input_matrix[line_index+1][index] = "|"
                
#         #split beam to the left, but only if beam doesnt already exist there
#         if value == "|" and input_matrix[line_index+1][index] == "^" and input_matrix[line_index+1][index-1] == ".":
#             input_matrix[line_index+1][index-1] = "|"
#             split = True
            
#         #split beam to the right, but only if beam doesnt already exist there  (can it even exist? dont think so...)
#         if value == "|" and input_matrix[line_index+1][index] == "^" and input_matrix[line_index+1][index+1] == ".":
#             input_matrix[line_index+1][index+1] = "|"
#             split = True
#         if split == True:
#             solution += 1
#     #print(solution)
            
#--------------------------------------------------------------------------------------------------------------------------------------
#task2

solution = 0



rows = len(input_matrix)
cols = len(input_matrix[0])

number_list:list = [[0 for _ in range(cols)] for _ in range(rows)]






#solution thanks to https://www.reddit.com/r/adventofcode/comments/1pgbg8a/2025_day_7_part_2_visualization_for_the_sample/

# #beam downward trajectory
for line_index, line in enumerate(input_matrix[:-1]):
    #print_manifold()
    for index, value in enumerate(line):
        #Starting beam
        if (value == "S"):
            input_matrix[line_index+1][index] = "|"
            number_list[line_index+1][index] += 1
        
        #continue beam downwards, if theres nothing in the way
        if value == "|" and input_matrix[line_index+1][index] != "^":
            input_matrix[line_index+1][index] = "|"
            number_list[line_index+1][index] += number_list[line_index][index]
            
                
        #split beam to the left, but only if beam doesnt already exist there
        if value == "|" and input_matrix[line_index+1][index] == "^":
            input_matrix[line_index+1][index-1] = "|"
            number_list[line_index+1][index-1] += number_list[line_index][index]
            
        #split beam to the right, but only if beam doesnt already exist there  (can it even exist? dont think so...)
        if value == "|" and input_matrix[line_index+1][index] == "^":
            input_matrix[line_index+1][index+1] = "|"
            number_list[line_index+1][index+1] += number_list[line_index][index]
            
    # for line in number_list:
    #     print(line)
    # print("------------------------------------------------------------------")


# print_manifold()

# for line in number_list:
#     print(line)

for number in number_list[-1]:
    solution += number

print(solution)